webpackJsonp([15],{"8hW3":function(e,t){},tzCB:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={name:"ResourceManagement",data:function(){return{backendURL:this.$axios.defaults.baseURL,isEmpty:!1,tableData:[],multipleSelection:[],pageData:{user_id:"",currentPage:-1,total:-1,pageSize:10,searcher:""},hostURL:"",hadSelected:!1,isIndeterminate:!0,dialogFormVisible:!1,updateResourceForm:{id:"",origin_name:"",enabled:"",discipline:"",description:""},formLabelWidth:"120px",rules:{origin_name:[{required:!0,message:this.$t("resourceManagement.rule1"),trigger:"change"}],discipline:[{required:!0,message:this.$t("resourceManagement.rule2"),trigger:"change"}],description:[{required:!0,message:this.$t("resourceManagement.rule3"),trigger:"change"}]}}},created:function(){this.hostURL="/resource/getInfoList",this.getUserResourceList()},methods:{handleSizeChange:function(e){this.pageData.pageSize=e,this.getUserResourceList()},handleCurrentChange:function(e){this.pageData.currentPage=e,this.getUserResourceList()},getUserResourceList:function(){var e=this,t=this.$cookies.get("user_id");if(!t)return this.$message({message:this.$t("sessionExpired"),type:"warning"}),void(this.isEmpty=!0);this.pageData.user_id=t;var a=this;this.$axios.post(this.hostURL,this.pageData).then(function(t){var i=t.data;if(4015===i.code||4018===i.code){a.tableData=i.data.pageList,a.pageData.currentPage=i.data.currentPage,a.pageData.total=i.data.total,a.pageData.pageSize=i.data.pageSize;for(var r=0;r<a.tableData.length;++r)a.tableData[r].discipline=a.translateDisciplineToSelectedLanguage(a.tableData[r].discipline)}else e.$message.error(i.code+" ~~~~ "+a.$t("serverError"));e.isEmpty=!1})},submitForm:function(){this.pageData.searcher&&(this.pageData.currentPage=-1,this.pageData.total=-1,this.hostURL="/resource/search",this.getUserResourceList())},resetForm:function(){this.pageData.searcher="",this.hostURL="/resource/getInfoList",this.pageData.total=-1,this.pageData.currentPage=-1,this.getUserResourceList()},deleteRow:function(e){this.deleteListOfResource([].concat(e))},handleSelectionChange:function(e){this.multipleSelection=e,this.hadSelected=!0,0==e.length&&(this.hadSelected=!1)},deleteListOfResource:function(e){var t=this,a=this;this.$axios.post("/resource/delete",e).then(function(i){var r=i.data;4019===r.code?(a.$message({message:r.code+" ~~~~  "+a.$t("deleteSuccess"),type:"success",center:!0,duration:2e3}),t.pageData.currentPage=-1,t.pageData.total=-1,t.pageData.searcher="",a.pageData.total-=e.length,a.getUserResourceList()):a.$message({message:r.code+" ~~~~  "+a.$t("serverError"),type:"error",center:!0,duration:2e3})}),this.toggleSelection()},toggleSelection:function(){this.$refs.multipleTable.clearSelection(),this.multipleSelection=[]},showUpdateForm:function(e){this.dialogFormVisible=!0,this.updateResourceForm.origin_name=e.origin_name,this.updateResourceForm.enabled=e.enabled,this.updateResourceForm.id=e.id,this.updateResourceForm.description=e.description,this.updateResourceForm.discipline=e.discipline},updateResource:function(e){var t=this;this.dialogFormVisible=!1;var a=this.updateResourceForm.origin_name;this.updateResourceForm.origin_name=this.updateResourceForm.origin_name.replace(/\s*/g,""),this.$refs[e].validate(function(e){if(e){t.updateResourceForm.origin_name=a;var i=t;t.$axios.post("/resource/updateInfo",t.updateResourceForm).then(function(e){var a=e.data;4021===a.code?i.$router.go(0):t.$message.error(a.code+"~~~~  "+out_this.$t("serverError"))})}else t.$message.error(t.$t("resourceManagement.notice2"))})},formatFileSize:function(e){return e<1024?e+=" kb":e=e<1048576?(e/1024).toFixed(2)+" Mb":(e/1024/1024).toFixed(2)+" GB",e},translateDisciplineToSelectedLanguage:function(e){switch(e){case"全部":return this.$t("recommendationContent.all");case"法学":return this.$t("disciplines.law");case"工学":return this.$t("disciplines.engineering");case"管理学":return this.$t("disciplines.management");case"计算机科学":return this.$t("disciplines.computerScience");case"教育学":return this.$t("disciplines.education");case"经济学":return this.$t("disciplines.economics");case"军事学":return this.$t("disciplines.militaryScience");case"理学":return this.$t("disciplines.science");case"历史学":return this.$t("disciplines.history");case"农学":return this.$t("disciplines.agronomy");case"文学":return this.$t("disciplines.literature");case"医学":return this.$t("disciplines.medicine");case"艺术学":return this.$t("disciplines.artStudies");case"哲学":return this.$t("disciplines.philosophy")}}}},r={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"div_resource_table"}},[this.isEmpty?a("el-empty",{staticStyle:{margin:"20% auto"},attrs:{description:""+e.$t("notFound404")}}):a("div",{staticStyle:{margin:"3%",width:"94%"}},[a("h3",[e._v(e._s(e.$t("resourceManagement.title")))]),e._v(" "),a("el-form",{ref:"searchForm",staticStyle:{width:"100%",margin:"10px auto"},attrs:{model:e.pageData,"label-width":"100px",align:"right"}},[a("el-form-item",[a("el-input",{staticStyle:{width:"30%","margin-right":"20px"},attrs:{placeholder:""+e.$t("resourceManagement.placeholderPrompt")},model:{value:e.pageData.searcher,callback:function(t){e.$set(e.pageData,"searcher",t)},expression:"pageData.searcher"}}),e._v(" "),a("el-button",{attrs:{type:"primary",icon:"el-icon-search",circle:""},on:{click:e.submitForm}}),e._v(" "),a("el-button",{attrs:{type:"info",circle:""},on:{click:e.resetForm}},[a("i",{staticClass:"el-icon-refresh"})]),e._v(" "),[a("el-popconfirm",{attrs:{title:""+e.$t("resourceManagement.confirmDelete")},on:{confirm:function(t){return e.deleteListOfResource(e.multipleSelection)},cancel:e.toggleSelection}},[a("el-button",{directives:[{name:"show",rawName:"v-show",value:e.hadSelected,expression:"hadSelected"}],staticStyle:{"margin-left":"20px"},attrs:{slot:"reference",type:"danger",round:""},slot:"reference"},[e._v("\n              "+e._s(e.$t("delete"))+"\n            ")])],1)]],2)],1),e._v(" "),a("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.tableData,"default-sort":{prop:"upload_time",order:"descending"}},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"50"}}),e._v(" "),a("el-table-column",{attrs:{prop:"upload_time",label:""+e.$t("resourceManagement.uploadDate"),sortable:"","min-width":"150"}}),e._v(" "),a("el-table-column",{attrs:{prop:"origin_name",label:""+e.$t("resourceManagement.fileName"),"min-width":"200"}}),e._v(" "),a("el-table-column",{attrs:{prop:"state",label:""+e.$t("resourceManagement.state"),"min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(t){return["审批中"===t.row.state?a("el-tag",{attrs:{type:"danger"}},[a("i",{staticClass:"el-icon-loading"}),e._v(e._s(e.$t("resourceManagement.checking"))+"\n          ")]):a("el-tag",{attrs:{type:"success"}},[e._v("\n            "+e._s(e.$t("resourceManagement.passed"))+"\n          ")])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"downloads",label:""+e.$t("resourceManagement.downloadTimes"),sortable:"","min-width":"100px"}}),e._v(" "),a("el-table-column",{attrs:{prop:"favorite_number",label:""+e.$t("resourceManagement.favouriteTimes"),sortable:"","min-width":"100px"}}),e._v(" "),a("el-table-column",{attrs:{prop:"size",label:""+e.$t("resourceManagement.size"),sortable:"","min-width":"100px"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(e.formatFileSize(t.row.size))+"\n        ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"enabled",label:""+e.$t("resourceManagement.enable"),"min-width":"100px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-switch",{attrs:{disabled:"","active-color":"#13ce66","inactive-color":"#ff4949"},model:{value:1==t.row.enabled,callback:function(a){e.$set(t.row,"enabled == 1",a)},expression:"scope.row.enabled == 1"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"discipline",label:""+e.$t("resourceManagement.discipline"),"min-width":"150px"}}),e._v(" "),a("el-table-column",{attrs:{label:""+e.$t("resourceManagement.introduction"),"min-width":"100px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popover",{attrs:{placement:"bottom",title:""+e.$t("resourceManagement.introduction"),width:"500",trigger:"click",content:t.row.description}},[a("el-button",{attrs:{slot:"reference"},slot:"reference"},[e._v(e._s(e.$t("resourceManagement.browse")))])],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{label:""+e.$t("resourceManagement.operation"),"min-width":"150px",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.deleteRow(t.row)}}},[e._v(e._s(e.$t("delete")))]),e._v(" "),a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.showUpdateForm(t.row)}}},[e._v(e._s(e.$t("resourceManagement.edit")))]),e._v(" "),a("a",{attrs:{href:e.backendURL+"/resource/download/"+t.row.disk_name+"/"+t.row.id+"/"+t.row.discipline}},[a("el-button",{attrs:{type:"text"}},[e._v(e._s(e.$t("download")))])],1)]}}])})],1),e._v(" "),a("el-dialog",{staticStyle:{margin:"20px auto"},attrs:{title:""+e.$t("resourceManagement.modifyResource"),visible:e.dialogFormVisible,center:""},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{ref:"updateResourceForm",staticStyle:{width:"80%",margin:"20px auto"},attrs:{model:e.updateResourceForm,rules:e.rules}},[a("el-form-item",{attrs:{label:""+e.$t("resourceManagement.setNewFileName"),prop:"origin_name","label-width":e.formLabelWidth}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.updateResourceForm.origin_name,callback:function(t){e.$set(e.updateResourceForm,"origin_name",t)},expression:"updateResourceForm.origin_name"}})],1),e._v(" "),1==e.updateResourceForm.enabled?a("el-form-item",{attrs:{label:""+e.$t("resourceManagement.disableResource"),"label-width":e.formLabelWidth}},[a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-value":"1","inactive-value":"0"},model:{value:e.updateResourceForm.enabled,callback:function(t){e.$set(e.updateResourceForm,"enabled",t)},expression:"updateResourceForm.enabled"}})],1):a("el-form-item",{attrs:{label:""+e.$t("resourceManagement.enableResource"),"label-width":e.formLabelWidth}},[a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-value":"1","inactive-value":"0"},model:{value:e.updateResourceForm.enabled,callback:function(t){e.$set(e.updateResourceForm,"enabled",t)},expression:"updateResourceForm.enabled"}})],1),e._v(" "),a("el-form-item",{attrs:{label:""+e.$t("resourceManagement.categories"),prop:"discipline","label-width":e.formLabelWidth}},[a("el-select",{attrs:{placeholder:""+e.$t("resourceManagement.notice1")},model:{value:e.updateResourceForm.discipline,callback:function(t){e.$set(e.updateResourceForm,"discipline",t)},expression:"updateResourceForm.discipline"}},[a("el-option",{attrs:{label:""+e.$t("disciplines.computerScience"),value:"计算机科学"}}),e._v(" "),a("el-option",{attrs:{label:""+e.$t("disciplines.philosophy"),value:"哲学"}}),e._v(" "),a("el-option",{attrs:{label:""+e.$t("disciplines.literature"),value:"文学"}}),e._v(" "),a("el-option",{attrs:{label:""+e.$t("disciplines.economics"),value:"经济学"}}),e._v(" "),a("el-option",{attrs:{label:""+e.$t("disciplines.artStudies"),value:"艺术学"}}),e._v(" "),a("el-option",{attrs:{label:""+e.$t("disciplines.science"),value:"理学"}}),e._v(" "),a("el-option",{attrs:{label:""+e.$t("disciplines.engineering"),value:"工学"}}),e._v(" "),a("el-option",{attrs:{label:""+e.$t("disciplines.education"),value:"教育学"}}),e._v(" "),a("el-option",{attrs:{label:""+e.$t("disciplines.history"),value:"历史学"}}),e._v(" "),a("el-option",{attrs:{label:""+e.$t("disciplines.medicine"),value:"医学"}}),e._v(" "),a("el-option",{attrs:{label:""+e.$t("disciplines.militaryScience"),value:"军事学"}}),e._v(" "),a("el-option",{attrs:{label:""+e.$t("disciplines.management"),value:"管理学"}}),e._v(" "),a("el-option",{attrs:{label:""+e.$t("disciplines.law"),value:"法学"}}),e._v(" "),a("el-option",{attrs:{label:""+e.$t("disciplines.agronomy"),value:"农学"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:""+e.$t("resourceManagement.introduction"),prop:"description","label-width":e.formLabelWidth}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:6,maxRows:10},placeholder:""+e.$t("resourceManagement.placeholderPrompt2")},model:{value:e.updateResourceForm.description,callback:function(t){e.$set(e.updateResourceForm,"description",t)},expression:"updateResourceForm.description"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("\n          "+e._s(e.$t("cancelButton"))+"\n        ")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.updateResource("updateResourceForm")}}},[e._v("\n          "+e._s(e.$t("confirmButton"))+"\n        ")])],1)],1),e._v(" "),a("div",{staticClass:"block",attrs:{align:"center"}},[a("br"),e._v(" "),a("el-pagination",{attrs:{background:"","current-page":e.pageData.currentPage,"page-size":e.pageData.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.pageData.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)],1)},staticRenderFns:[]};var s=a("VU/8")(i,r,!1,function(e){a("8hW3")},"data-v-8012679a",null);t.default=s.exports}});
//# sourceMappingURL=15.684dc764b81fafe1444f.js.map