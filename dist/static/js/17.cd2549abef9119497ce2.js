webpackJsonp([17],{E4zG:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s={name:"UserManager",data:function(){return{userPageData:{user_id:"",currentPage:-1,pageSize:10,total:-1},userTableList:[],tableSelectList:[],addUserForm:{username:"",password:""},rules:{username:[{required:!0,message:this.$t("userManager.rule1"),trigger:"blur"},{min:5,max:10,message:this.$t("userManager.rule2"),trigger:"blur"}],password:[{required:!0,message:this.$t("userManager.rule3"),trigger:"blur"},{min:6,max:20,message:this.$t("userManager.rule4"),trigger:"blur"}]},dialogFormVisible:!1,deleteButtonVisible:!1}},created:function(){this.getAdminLoginInfo(),this.loadUserAccountInfoList()},methods:{handleSizeChange:function(e){this.userPageData.pageSize=e,this.loadUserAccountInfoList()},handleCurrentChange:function(e){this.userPageData.currentPage=e,this.loadUserAccountInfoList()},getAdminLoginInfo:function(){var e=this.$cookies.get("user_id");return e?(this.userPageData.user_id=e,e):(this.$message.info(this.$t("sessionExpired")),!1)},loadUserAccountInfoList:function(){var e=this;this.$axios.post("/admin/getUserList",this.userPageData).then(function(t){var a=t.data;console.log(a),8001===a.code?(e.userPageData.currentPage=a.data.currentPage,e.userPageData.pageSize=a.data.pageSize,e.userPageData.total=a.data.total,e.userTableList=a.data.pageList):e.$message.error(a.code+"~~~~"+e.$t("serverError"))})},handleSelectionChange:function(){for(var e=0;e<this.$refs.multipleTable.selection.length;++e){for(var t=!1,a=0;a<this.$refs.multipleTable.selection[e].roles.length;++a)if("admin"===this.$refs.multipleTable.selection[e].roles[a]){t=!0;break}t&&(this.$refs.multipleTable.selection.splice(e,1),this.$message.info(this.$t("userManager.insufficientPrivilege")))}this.tableSelectList=this.$refs.multipleTable.selection},cancelSelectionHandler:function(){this.$refs.multipleTable.clearSelection(),this.tableSelectList=[]},addUserHandler:function(){if(this.invalidForm()){var e=this;this.$axios.post("/auth/register",this.addUserForm).then(function(t){var a=t.data;console.log(a),1003===a.code?(e.$message({message:a.code+"~~~~"+e.$t("userManager.registerSuccess"),type:"success",duration:2e3}),e.loadUserAccountInfoList()):e.$message.error(a.code+"~~~~"+e.$t("userManager.registerFailed"))}),this.cancelSelectionHandler(),this.dialogFormVisible=!1}},invalidForm:function(){var e=this.addUserForm.username,t=this.addUserForm.password;if(0===e.replace(/\s*/g,"").length)return this.$message.error(this.$t("userManager.rule5")),!1;if(e.includes(" "))return this.$message.error(this.$t("userManager.rule6")),!1;if(0===t.replace(/\s*/g,"").length)return this.$message.error(this.$t("userManager.rule7")),!1;if(t.includes(" "))return this.$message.error(this.$t("userManager.rule8")),!1;var a=e.length,s=t.length;return a>=5&&a<=10&&(s>=6&&s<=20)},addLockOnUserAccount:function(){if(this.tableSelectList=this.clearRepeatedHandler(this.tableSelectList,0),0!==this.tableSelectList.length){var e=this;this.$axios.post("/admin/lockAccounts",this.tableSelectList).then(function(t){var a=t.data;if(console.log(a),8002===a.code){e.$message({message:a.code+"~~~~  "+e.$t("operationSuccess"),type:"success",center:!0,duration:2e3});for(var s=a.data,r=0;r<s.length;++r)for(var n=0;n<e.userTableList.length;++n)s[r]===e.userTableList[n].id&&(e.userTableList[n].enabled=0)}else e.$message.error(a.code+"~~~~"+e.$t("serverError"))}),this.cancelSelectionHandler()}else this.$message.info(this.$t("userManager.invalidSelection"))},unlockUserAccount:function(){if(this.tableSelectList=this.clearRepeatedHandler(this.tableSelectList,1),0!==this.tableSelectList.length){var e=this;this.$axios.post("/admin/unlockAccounts",this.tableSelectList).then(function(t){var a=t.data;if(console.log(a),8004===a.code){e.$message({message:a.code+"~~~~  "+e.$t("operationSuccess"),type:"success",center:!0,duration:2e3});for(var s=a.data,r=0;r<s.length;++r)for(var n=0;n<e.userTableList.length;++n)s[r]===e.userTableList[n].id&&(e.userTableList[n].enabled=1)}else e.$message.error(a.code+"~~~~"+e.$t("serverError"))}),this.cancelSelectionHandler()}else this.$message.info(this.$t("userManager.invalidSelection"))},clearRepeatedHandler:function(e,t){for(var a=[],s=0;s<e.length;++s)e[s].enabled!==t&&a.push(e[s]);return a}}},r={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"div_user_manager_box"}},[0===e.userTableList.length?a("el-empty",{staticStyle:{margin:"20% auto"},attrs:{description:""+e.$t("userManager.withoutUserInfo")}}):a("div",[a("h3",[e._v(e._s(e.$t("userManager.title")))]),e._v(" "),a("div",{staticStyle:{width:"100%"}},[a("div",{staticStyle:{width:"100%"}},[a("el-button",{attrs:{icon:"el-icon-plus",type:"primary",size:"small"},on:{click:function(t){e.dialogFormVisible=!0}}},[e._v("\n          "+e._s(e.$t("userManager.addUser"))+"\n        ")]),e._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:0!==e.tableSelectList.length,expression:"tableSelectList.length !== 0"}],attrs:{type:"danger",size:"small",round:""},on:{click:e.addLockOnUserAccount}},[e._v("\n          "+e._s(e.$t("userManager.lockAccount"))+"\n        ")]),e._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:0!==e.tableSelectList.length,expression:"tableSelectList.length !== 0"}],attrs:{type:"success",size:"small",round:""},on:{click:e.unlockUserAccount}},[e._v("\n          "+e._s(e.$t("userManager.activateAccount"))+"\n        ")]),e._v(" "),a("el-dialog",{attrs:{title:""+e.$t("userManager.addUserAccount"),width:"500px",center:"",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{attrs:{model:e.addUserForm,rules:e.rules}},[a("el-form-item",{attrs:{label:""+e.$t("userManager.username"),prop:"username"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.addUserForm.username,callback:function(t){e.$set(e.addUserForm,"username",t)},expression:"addUserForm.username"}})],1),e._v(" "),a("el-form-item",{attrs:{label:""+e.$t("userManager.password"),prop:"password"}},[a("el-input",{attrs:{type:"password","show-password":"",autocomplete:"off"},model:{value:e.addUserForm.password,callback:function(t){e.$set(e.addUserForm,"password",t)},expression:"addUserForm.password"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v(e._s(e.$t("userManager.cancel")))]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.addUserHandler}},[e._v(e._s(e.$t("userManager.confirmation")))])],1)],1)],1),e._v(" "),a("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.userTableList,"default-sort":{prop:"create_time",order:"descending"}},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{prop:"create_time",label:""+e.$t("userManager.registerDate"),sortable:"","min-width":"150"}}),e._v(" "),a("el-table-column",{attrs:{prop:"username",label:""+e.$t("userManager.account"),"min-width":"110"}}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:""+e.$t("userManager.alias"),"min-width":"100"}}),e._v(" "),a("el-table-column",{attrs:{prop:"enabled",label:""+e.$t("userManager.state"),"min-width":"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[1===t.row.enabled?a("el-tag",{attrs:{type:"success"}},[e._v("\n              "+e._s(e.$t("userManager.using"))+"\n            ")]):a("el-tag",{attrs:{type:"danger"}},[a("i",{staticClass:"fa fa-lock"}),e._v(e._s(e.$t("userManager.locked"))+"\n            ")])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"email",label:""+e.$t("userManager.email"),"min-width":"150"}}),e._v(" "),a("el-table-column",{attrs:{prop:"roles",label:""+e.$t("userManager.privilege"),"min-width":"100"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.roles,function(t,s){return a("el-tag",{key:s,attrs:{type:"danger"}},[e._v("\n              "+e._s(t)+"\n            ")])})}}])})],1)],1),e._v(" "),a("div",{staticClass:"block",attrs:{align:"center"}},[a("br"),e._v(" "),a("el-pagination",{attrs:{background:"","current-page":e.userPageData.currentPage,"page-size":e.userPageData.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.userPageData.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)])],1)},staticRenderFns:[]};var n=a("VU/8")(s,r,!1,function(e){a("nBFZ")},"data-v-415eaef5",null);t.default=n.exports},nBFZ:function(e,t){}});
//# sourceMappingURL=17.cd2549abef9119497ce2.js.map