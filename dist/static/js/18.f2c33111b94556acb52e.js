webpackJsonp([18],{"6On6":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={name:"CommentManager",data:function(){return{isEmpty:!1,commentTableData:[],multipleSelection:[],commentPageData:{user_id:"",currentPage:-1,total:-1,pageSize:10},hadSelected:!1}},created:function(){this.getCommentList()},methods:{handleSizeChange:function(e){this.commentPageData.pageSize=e,this.getCommentList()},handleCurrentChange:function(e){this.commentPageData.currentPage=e,this.getCommentList()},getCommentList:function(){if(this.getLoginInfo()){var e=this;this.$axios.post("/comment/manager",this.commentPageData).then(function(t){var a=t.data;console.log(a),5005===a.code?(e.commentTableData=a.data.pageList,e.commentPageData.currentPage=a.data.currentPage,e.commentPageData.total=a.data.total,e.commentPageData.pageSize=a.data.pageSize):e.$message.error(a.code+"~~~~  "+e.$t("serverError"))})}},handleSelectionChange:function(e){this.multipleSelection=e,this.hadSelected=!0,0==e.length&&(this.hadSelected=!1)},toggleSelection:function(){this.$refs.multipleTable.clearSelection(),this.multipleSelection=[]},deleteRow:function(e){this.deleteListOfComment([].concat(e))},deleteListOfComment:function(e){var t=this,a=this;this.$axios.post("/comment/delete",e).then(function(e){var n=e.data;console.log(n),5006===n.code?(a.$message({message:n.code+"~~~~  "+a.$t("deleteSuccess"),type:"success",center:!0,duration:2e3}),a.getCommentList()):t.$message.error(n.code+"~~~~  "+a.$t("serverError"))}),this.toggleSelection()},goCommentDetailPage:function(e){this.$cookies.remove("resource_id"),this.$cookies.set("resource_id",e.resource_id),this.$router.push("/detail")},getLoginInfo:function(){var e=this.$cookies.get("user_id");return e?(this.commentPageData.user_id=e,!0):(this.$message({message:this.$t("sessionExpired"),type:"warning"}),this.isEmpty=!0,!1)},tableRowClassName:function(e){var t=e.row;e.index;return 1==t.isIllegal?"warning-row":"success-row"}}},o={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"div_comment_table"}},[this.isEmpty?a("el-empty",{staticStyle:{margin:"20% auto"},attrs:{description:""+e.$t("sessionExpired")}}):a("div",{staticStyle:{margin:"3%",width:"100%"}},[a("h3",[e._v(e._s(e.$t("commentManager.title")))]),e._v(" "),a("el-form",{ref:"searchForm",attrs:{model:e.commentPageData}},[a("el-form-item",[[a("el-popconfirm",{attrs:{title:""+e.$t("commentManager.confirmPrompt")},on:{confirm:function(t){return e.deleteListOfComment(e.multipleSelection)},cancel:e.toggleSelection}},[a("el-button",{directives:[{name:"show",rawName:"v-show",value:e.hadSelected,expression:"hadSelected"}],staticStyle:{"margin-left":"20px"},attrs:{slot:"reference",type:"danger",round:""},slot:"reference"},[e._v(e._s(e.$t("delete"))+"\n            ")])],1)]],2)],1),e._v(" "),a("div",{attrs:{id:"bigger-box"}}),e._v(" "),a("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.commentTableData,"row-class-name":e.tableRowClassName,"default-sort":{prop:"time",order:"descending"}},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"50"}}),e._v(" "),a("el-table-column",{attrs:{prop:"time",label:""+e.$t("date"),sortable:"","min-width":"100"}}),e._v(" "),a("el-table-column",{attrs:{label:""+e.$t("commentManager.judgement"),"min-width":"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[1==t.row.isIllegal?a("el-tag",{attrs:{type:"danger"}},[e._v("\n            "+e._s(e.$t("commentManager.inappropriate"))+"\n          ")]):a("el-tag",{attrs:{type:"success"}},[e._v("\n            "+e._s(e.$t("commentManager.appropriate"))+"\n          ")])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"resource_name",label:""+e.$t("commentManager.resourceName"),sortable:"","min-width":"200"}}),e._v(" "),a("el-table-column",{attrs:{prop:"support_number",label:""+e.$t("commentManager.supportNumber"),sortable:"","min-width":"100"}}),e._v(" "),a("el-table-column",{attrs:{label:""+e.$t("commentManager.reply"),"min-width":"150px"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.to_name?a("el-tag",{attrs:{type:"info"}},[e._v(e._s("@"+t.row.to_name))]):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"content",label:""+e.$t("commentManager.content"),sortable:"","min-width":"300"}}),e._v(" "),a("el-table-column",{attrs:{label:""+e.$t("commentManager.operation"),"min-width":"100px",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popconfirm",{attrs:{title:""+e.$t("commentManager.confirmPrompt")},on:{confirm:function(a){return e.deleteRow(t.row)},cancel:e.toggleSelection}},[a("el-button",{attrs:{slot:"reference",type:"text",plain:""},slot:"reference"},[e._v(e._s(e.$t("delete")))])],1),e._v(" "),a("el-button",{attrs:{type:"text",plain:""},on:{click:function(a){return e.goCommentDetailPage(t.row)}}},[e._v(e._s(e.$t("commentManager.browse")))])]}}])})],1),e._v(" "),a("div",{staticClass:"block",attrs:{align:"center"}},[a("br"),e._v(" "),a("el-pagination",{attrs:{background:"","current-page":e.commentPageData.currentPage,"page-size":e.commentPageData.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.commentPageData.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)],1)},staticRenderFns:[]};var r=a("VU/8")(n,o,!1,function(e){a("RaNQ")},"data-v-3c1298ba",null);t.default=r.exports},RaNQ:function(e,t){}});
//# sourceMappingURL=18.f2c33111b94556acb52e.js.map