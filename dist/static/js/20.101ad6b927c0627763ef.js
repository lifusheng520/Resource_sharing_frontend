webpackJsonp([20],{VgdF:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={name:"FavouriteFolderManager",data:function(){return{folderPageData:{user_id:"",currentPage:-1,total:-1,pageSize:10},folderTableData:[],folderSelectList:[],visible:!1,dialogFormVisible:!1,newFolderForm:{user_id:"",folder_name:""}}},created:function(){this.getLoginUserInfo(),this.loadFavouriteFolderInfoList()},methods:{handleSelectionChange:function(){var e=this.removeDefaultFolder();this.folderSelectList=e},removeDefaultFolder:function(){for(var e=-1,t=0;t<this.$refs.multipleTable.selection.length;++t)if("默认收藏夹"===this.$refs.multipleTable.selection[t].folder_name){e=t;break}return-1!=e?(this.$refs.multipleTable.selection.splice(e,1),this.$message.info(this.$t("favouriteFolderManager.denialOperation")),this.$refs.multipleTable.selection):this.$refs.multipleTable.selection},handleSizeChange:function(e){this.folderPageData.pageSize=e,this.loadFavouriteFolderInfoList()},handleCurrentChange:function(e){this.folderPageData.currentPage=e,this.loadFavouriteFolderInfoList()},getLoginUserInfo:function(){var e=this.$cookies.get("user_id");e?this.folderPageData.user_id=e:(this.$message.info(this.$t("sessionExpired")),this.$router.push("/login"))},loadFavouriteFolderInfoList:function(){var e=this;this.$axios.post("/favourite/getFolders",this.folderPageData).then(function(t){var a=t.data;7015===a.code?(e.folderPageData.currentPage=a.data.currentPage,e.folderPageData.pageSize=a.data.pageSize,e.folderPageData.total=a.data.total,e.folderTableData=a.data.pageList):e.$message.error(a.code+"~~~~"+e.$t("serverError"))})},getTimePass:function(e){var t=(new Date).getTime(),a=void 0,r=parseInt((t-e)/1e3);r<60&&(a=this.$t("withinOneMinute")),r=parseInt(r/60),!a&&r<60&&(a=r+this.$t("minutesAgo"));var o=parseInt(r/60),i=r%60;!a&&o<24&&(a=o+this.$t("hour")+i+this.$t("minutesAgo"));var l=parseInt(o/24);o%=24,!a&&l<30&&(a=l+this.$t("day")+o+this.$t("hoursAgo"));var n=(new Date).getFullYear()-new Date(e).getFullYear(),s=(new Date).getMonth()-new Date(e).getMonth();return s=Math.abs(s),!a&&n>0&&s>0&&(a=n+this.$t("year")+s+this.$t("monthsAgo")),!a&&n>0&&0===s&&(a=n+this.$t("yearsAgo")),!a&&0===n&&s>0&&(a=s+this.$t("monthsAgo")),a},timeFormat:function(e){var t=new Date(e),a=t.getFullYear(),r=t.getMonth()+1,o=t.getDate(),i=t.getHours(),l=t.getMinutes(),n=t.getSeconds();return a+"-"+(r<10?"0"+r:r)+"-"+(o<10?"0"+o:o)+" "+(i<10?"0"+i:i)+":"+(l<10?"0"+l:l)+":"+(n<10?"0"+n:n)},deleteFavouriteFolders:function(){console.log(this.folderSelectList);var e=this;this.$axios.post("/favourite/deleteFolders",this.folderSelectList).then(function(t){var a=t.data;7016===a.code?(e.$message({message:a.code+" ~~~~  "+e.$t("deleteSuccess"),type:"success",center:!0,duration:2e3}),e.folderPageData.currentPage=-1,e.folderPageData.total=-1,e.loadFavouriteFolderInfoList()):e.$message.error(a.code+" ~~~~ "+e.$t("serverError"))}),this.cancelSelect()},cancelSelect:function(){this.folderSelectList=[],this.$refs.multipleTable.clearSelection()},newFolderHandler:function(){this.dialogFormVisible=!1;var e=this.$cookies.get("user_id");if(!e)return this.$message.info(this.$t("sessionExpired")),0;if(!this.newFolderForm.folder_name)return this.$message.info(this.$t("favouriteFolderManager.rule1")),0;this.newFolderForm.user_id=e;var t=this;this.$axios.post("/favourite/addFolder",this.newFolderForm).then(function(e){var a=e.data;7006==a.code?(t.$message({message:a.code+" ~~~~ "+t.$t("operationSuccess"),type:"success",duration:2e3}),t.folderPageData.currentPage=-1,t.folderPageData.total=-1,t.loadFavouriteFolderInfoList()):t.$message.error(a.code+" ~~~~ "+t.$t("serverError"))}),this.newFolderForm.folder_name=""}}},o={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"div_favourite_folder_box"}},[0===this.folderTableData.length?a("el-empty",{staticStyle:{margin:"20% auto"},attrs:{description:"啥也没有哇~~~"}}):a("div",{staticStyle:{margin:"3%",width:"94%"}},[a("div",[a("h3",[e._v(e._s(e.$t("favouriteFolderManager.title")))]),e._v(" "),a("br"),e._v(" "),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){e.dialogFormVisible=!0}}},[e._v(e._s(e.$t("favouriteFolderManager.newFolder")))]),e._v(" "),a("el-dialog",{attrs:{center:"",title:""+e.$t("favouriteFolderManager.newFolder"),visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{attrs:{model:e.newFolderForm}},[a("el-form-item",{attrs:{label:""+e.$t("favouriteFolderManager.albumName")}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.newFolderForm.folder_name,callback:function(t){e.$set(e.newFolderForm,"folder_name",t)},expression:"newFolderForm.folder_name"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v(e._s(e.$t("cancelButton")))]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.newFolderHandler}},[e._v(e._s(e.$t("confirmButton")))])],1)],1)],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:0!==this.folderSelectList.length,expression:"this.folderSelectList.length !== 0"}],staticClass:"div-operation-button"},[a("el-popover",{attrs:{placement:"top",width:"200",trigger:"click"},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[a("p",[e._v(e._s(e.$t("favouriteFolderManager.notice")))]),e._v(" "),a("div",{staticStyle:{"text-align":"right",margin:"0"}},[a("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(t){e.visible=!1}}},[e._v("\n            "+e._s(e.$t("cancelButton"))+"\n          ")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:[e.deleteFavouriteFolders,function(t){e.visible=!1}]}},[e._v("\n            "+e._s(e.$t("confirmButton"))+"\n          ")])],1),e._v(" "),a("el-button",{attrs:{slot:"reference",type:"danger",size:"small",plain:""},slot:"reference"},[e._v("\n          "+e._s(e.$t("delete"))+"\n        ")])],1),e._v(" "),a("el-button",{attrs:{size:"small",plain:""},on:{click:e.cancelSelect}},[e._v(e._s(e.$t("cancelButton")))])],1),e._v(" "),a("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.folderTableData,"tooltip-effect":"dark","default-sort":{prop:"time",order:"descending"}},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{prop:"time",label:""+e.$t("date"),sortable:"","min-width":"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(e.timeFormat(t.row.time))+"\n        ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"time",label:""+e.$t("favouriteFolderManager.duration"),sortable:"","min-width":"140"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(e.getTimePass(t.row.time))+"\n        ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"resourceNumber",label:""+e.$t("favouriteFolderManager.favouriteAmount"),sortable:"","min-width":"100"}}),e._v(" "),a("el-table-column",{attrs:{prop:"folder_name",label:""+e.$t("favouriteFolderManager.albumName"),"min-width":"320"}})],1),e._v(" "),a("div",{staticClass:"block",attrs:{align:"center"}},[a("br"),e._v(" "),a("el-pagination",{attrs:{background:"","current-page":e.folderPageData.currentPage,"page-size":e.folderPageData.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.folderPageData.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)],1)},staticRenderFns:[]};var i=a("VU/8")(r,o,!1,function(e){a("eEy1")},"data-v-3276f794",null);t.default=i.exports},eEy1:function(e,t){}});
//# sourceMappingURL=20.101ad6b927c0627763ef.js.map